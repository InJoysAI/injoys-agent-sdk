# æ–‡æ¡£æ”¶é›†ä¸å½’æ¡£æŒ‡ä»¤

> å½“è¢« `design/context-dev/AGENTS.md` è°ƒç”¨æ—¶æ‰§è¡Œæ­¤æ–‡ä»¶ã€‚

---

## ğŸ¯ æ‰§è¡ŒæŒ‡ä»¤

ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

---

### Phase 1: æ”¶é›†æºæ–‡ä»¶

**âš ï¸ å¿…é¡»æ‰§è¡Œ**: å‘ç”¨æˆ·è¯¢é—®ï¼š

> "è¯·æä¾›ä»¥ä¸‹æºæ–‡ä»¶ï¼ˆå¯æ‹–æ‹½æˆ–ç²˜è´´è·¯å¾„ï¼‰ï¼š
> 
> **å¿…éœ€æ–‡ä»¶**:
> - PRD äº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆå¤šä¸ªæ—¶è¯·æŒ‡å®šä¸» PRDï¼‰
> - æ¶æ„è®¾è®¡æ–‡æ¡£ï¼ˆä¼˜å…ˆä½¿ç”¨ç³»ç»Ÿæ¶æ„è®¾è®¡ï¼‰
> 
> **å¯é€‰æ–‡ä»¶**:
> - DB Schema è®¾è®¡æ–‡æ¡£
> - UI è®¾è®¡è§„èŒƒ
> - é—ç•™ä»£ç åº“/æ–‡æ¡£
> - å…¶ä»–è¡¥å……æ–‡æ¡£ï¼ˆå®‰å…¨ç™½çš®ä¹¦ã€åˆè§„è¦æ±‚ç­‰ï¼‰"

**ç­‰å¾…ç”¨æˆ·å›å¤åå†ç»§ç»­ã€‚**

---

## ğŸ“‚ æºæ–‡ä»¶å½’æ¡£æ˜ å°„

| æ–‡ä»¶ç±»å‹ | å¿…éœ€ | å½’æ¡£ç›®å½• | ç¼ºå¤±å¤„ç† |
|---------|:----:|---------|---------|
| PRD äº§å“éœ€æ±‚æ–‡æ¡£ | âœ… | `.context/domain/` | å¤šä¸ªæ—¶æŒ‡å®šä¸» PRD |
| æ¶æ„è®¾è®¡æ–‡æ¡£ | âœ… | `.context/architecture/` | ä¼˜å…ˆä½¿ç”¨ç³»ç»Ÿæ¶æ„è®¾è®¡ |
| DB Schema è®¾è®¡æ–‡æ¡£ | âš ï¸ | `.context/db/` | è·³è¿‡ `db/` |
| UI è®¾è®¡è§„èŒƒ | âš ï¸ | `.context/ui/` | è·³è¿‡ `ui/` |
| é—ç•™ä»£ç åº“/æ–‡æ¡£ | âš ï¸ | `.context/legacy/` | è·³è¿‡ `legacy/` |
| å…¶ä»–è¡¥å……æ–‡æ¡£ | âš ï¸ | æŒ‰å†…å®¹å½’æ¡£åˆ°å¯¹åº”ç›®å½• | è·³è¿‡ |

---

### Phase 2: åˆ›å»ºç›®å½•ç»“æ„

åˆ›å»ºä»¥ä¸‹ç›®å½•ï¼ˆè‹¥ä¸å­˜åœ¨ï¼‰ï¼š
- `.context/`
- `.context/architecture/`
- `.context/architecture/source/`
- `.context/domain/`
- `.context/domain/source/`
- `.context/db/` ï¼ˆè‹¥æœ‰ DB æ–‡æ¡£ï¼‰
- `.context/db/source/`
- `.context/ui/` ï¼ˆè‹¥æœ‰ UI æ–‡æ¡£ï¼‰
- `.context/ui/source/`
- `.context/openspec/`
- `.context/legacy/` ï¼ˆè‹¥æœ‰é—ç•™æ–‡æ¡£ï¼‰
- `.context/legacy/source/`

---

### Phase 3: å¤åˆ¶æºæ–‡æ¡£

å°†ç”¨æˆ·æä¾›çš„æºæ–‡æ¡£**åŸæ ·å¤åˆ¶**åˆ°å¯¹åº”çš„ `source/` å­ç›®å½•ï¼ˆä¿ç•™åŸæ–‡ä»¶åï¼‰ï¼š

| æºæ–‡æ¡£ç±»å‹ | å½’æ¡£ç›®å½• | æ“ä½œ |
|------------|---------|------|
| PRD | `.context/domain/source/` | å¤åˆ¶ |
| æ¶æ„è®¾è®¡ | `.context/architecture/source/` | å¤åˆ¶ |
| DB Schema | `.context/db/source/` | å¤åˆ¶ |
| UI è§„èŒƒ | `.context/ui/source/` | å¤åˆ¶ |
| é—ç•™**æ–‡æ¡£** | `.context/legacy/source/` | å¤åˆ¶ |
| é—ç•™**ä»£ç åº“** | - | âš ï¸ **ä¸å¤åˆ¶**ï¼Œè§ä¸‹æ–‡ |
| è¡¥å……æ–‡æ¡£ | æŒ‰å†…å®¹å½’æ¡£åˆ°å¯¹åº” `source/` | å¤åˆ¶ |

### é—ç•™ä»£ç åº“ç‰¹æ®Šå¤„ç†

> âš ï¸ **é—ç•™ä»£ç åº“ï¼ˆå¦‚ `golang-auth-api/`ï¼‰ä¸è¿›è¡Œæ–‡ä»¶å¤åˆ¶**

**å¤„ç†æ–¹å¼**ï¼š
1. **è®°å½•è·¯å¾„å¼•ç”¨** â€” åœ¨ Manifest çš„ `sources` ä¸­è®°å½•ä»£ç åº“è·¯å¾„
2. **ç”Ÿæˆå¼•ç”¨æ–‡ä»¶** â€” åœ¨ `.context/legacy/source/` åˆ›å»º `_codebase_ref.md`ï¼š

```markdown
# é—ç•™ä»£ç åº“å¼•ç”¨

> æ­¤æ–‡ä»¶ä¸ºå¼•ç”¨æŒ‡é’ˆï¼Œå®é™…ä»£ç åº“æœªå¤åˆ¶åˆ° .context/ ç›®å½•

**ä»£ç åº“è·¯å¾„**: `{{CODEBASE_PATH}}`
**è®°å½•æ—¶é—´**: `{{TIMESTAMP}}`

## è¯´æ˜
é—ç•™ä»£ç åº“ä½“ç§¯è¾ƒå¤§ï¼Œä¸é€‚åˆå¤åˆ¶åˆ° Context ç›®å½•ã€‚
åˆ†ææ—¶è¯·ç›´æ¥è¯»å–åŸå§‹è·¯å¾„ã€‚
```

3. **æ‰§è¡Œåˆ†æ** â€” æ‰§è¡Œ `@design/context-dev/legacy/AGENTS.md` ç›´æ¥è¯»å–åŸå§‹è·¯å¾„ç”Ÿæˆ `legacy_system_analysis.md`

> âš ï¸ **æºæ–‡æ¡£åªè¯»**: `source/` ç›®å½•ä¸­çš„æ–‡ä»¶ä¸ºæƒå¨æ¥æºï¼Œä¸å¾—ä¿®æ”¹ã€‚

æ¯ä¸ªå­ç›®å½•ç”Ÿæˆ `README.md` è¯´æ˜ï¼ˆä½œä¸ºå¿«é€Ÿç´¢å¼•ï¼‰ã€‚

---

### Phase 4: ç”Ÿæˆæ´¾ç”Ÿæ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

**å½“ç”¨æˆ·æœªæä¾›æŸç±»æºæ–‡ä»¶ï¼Œä½† PRD/æ¶æ„/å…¶ä»–æ–‡æ¡£ä¸­åŒ…å«ç›¸å…³å†…å®¹æ—¶**ï¼š

| ç¼ºå¤±çš„æºæ–‡ä»¶ | å¯ä» | ç”Ÿæˆä¸º | manifest è®°å½• |
|-------------|------|--------|---------------|
| UI è§„èŒƒ | PRD | `.context/ui/design_spec.md` | `source_ref: "PRD"`, `status: "generated"` |
| å®‰å…¨ç­–ç•¥ | æ¶æ„æ–‡æ¡£ | `.context/architecture/security_policy.md` | `source_ref: "TDS"`, `status: "generated"` |

**âš ï¸ å¿…é¡»æ‰§è¡Œ**: å‘ç”¨æˆ·ç¡®è®¤ï¼š

> "æœªæä¾› UI è§„èŒƒæºæ–‡ä»¶ï¼Œä½† PRD ä¸­åŒ…å« UI è®¾è®¡å†…å®¹ã€‚
> æ˜¯å¦ä» PRD ç”Ÿæˆ `.context/ui/design_spec.md`ï¼Ÿ(y/n)"

**ç­‰å¾…ç”¨æˆ·å›å¤åå†ç»§ç»­ã€‚**

ç”Ÿæˆæ—¶åœ¨ Manifest çš„ `sources` èŠ‚ç‚¹è®°å½•**åŸå§‹æ¥æº**ï¼š
```json
"UI_SPEC_DERIVED": {
  "path": ".context/ui/design_spec.md",
  "derived_from": "PRD",
  "type": "ui_design"
}
```

### Phase 5: ç”Ÿæˆæ ¹ç›®å½•æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ |
|------|------|
| `README.md` | ç”Ÿæˆç›®å½•è¯´æ˜ |
| `criterion.md` | è¯»å– `@design/context-dev/criterion.md` æ¨¡æ¿å¹¶å¡«å……å ä½ç¬¦ |
| `AGENTS.md` | ä½¿ç”¨ `templates/context-agents.md.template` |

**criterion.md å¡«å……è§„åˆ™**ï¼š
- ä»æ¶æ„æ–‡æ¡£**æå–æŠ€æœ¯æ ˆçº¦æŸ**å¡«å…¥ `{{...}}` å ä½ç¬¦
- **ä¿ç•™æ¨¡æ¿ç»“æ„**ï¼Œä¸åˆ é™¤ä»»ä½• Section
- é¡¶éƒ¨æ·»åŠ  Metadata

> ğŸ’¡ criterion.md æ˜¯å”¯ä¸€éœ€è¦è§£ææºæ–‡æ¡£çš„æ–‡ä»¶ï¼Œç”¨äºæå–æŠ€æœ¯çº¦æŸã€‚

---

## ğŸ“‹ å…¨å±€å…ƒæ•°æ®æ ¼å¼

ä»… `.context/` æ ¹ç›®å½•ç”Ÿæˆæ–‡ä»¶é¡¶éƒ¨æ·»åŠ ï¼š

```markdown
> **Metadata**
> - **Source**: `[æºæ–‡ä»¶è·¯å¾„]`
> - **Generated At**: `YYYY-MM-DD HH:mm`
> - **Generator**: `Context-Dev-Agent v1.0`
```

---

### Phase 6: æ›´æ–° Manifest

**æ‰§è¡Œ**: `@design/context-dev/tools/manifest/AGENTS.md` (mode: update)

---

## âœ… å®Œæˆå

æŠ¥å‘Šç»“æœï¼ˆç¤ºä¾‹ï¼Œè¦ä¾æ®çœŸå®æƒ…å†µï¼‰ï¼š

```
=== æºæ–‡æ¡£å½’æ¡£ ===
âœ… PRD.md â†’ .context/domain/PRD.md (å¤åˆ¶)
âœ… TDS.md â†’ .context/architecture/TDS.md (å¤åˆ¶)
â© DB: è·³è¿‡ï¼ˆæœªæä¾›ï¼‰

=== æ ¹ç›®å½•æ–‡ä»¶ ===
âœ… .context/README.md (ç”Ÿæˆ)
âœ… .context/criterion.md (ç”Ÿæˆ)
âœ… .context/AGENTS.md (ç”Ÿæˆ)

ğŸ” Manifest å·²æ›´æ–°
```
