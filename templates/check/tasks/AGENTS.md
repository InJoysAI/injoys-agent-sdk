# Tasks Check 指令

> 当 `/context-check tasks <change-id>` 被调用时执行此文件。

---

## 🎯 执行指令

> ⛔ **必须依次执行所有步骤**，不得跳过或中断。

---

## Phase 1: 确定提案 ID

### 1.1 若提供了 `<change-id>`

直接使用提供的 ID。

### 1.2 若未提供 `<change-id>`

列出 `openspec/changes/` 下的目录供用户选择：

```bash
ls openspec/changes/
```

> ⛔ **不得猜测提案 ID**，必须询问用户选择。

---

## Phase 2: 读取任务文件

读取 `openspec/changes/<change-id>/tasks.md`

**若文件不存在**：
- ❌ 失败，提示 `tasks.md 不存在`

---

## Phase 3: 解析任务状态

按 Markdown checkbox 格式解析：

| 标记 | 状态 | 说明 |
|------|------|------|
| `[x]` | ✅ 已完成 | 任务完成 |
| `[/]` | 🔄 进行中 | 正在执行（可选标记） |
| `[ ]` | ⬜ 待开始 | 未开始 |

**解析规则**：
- 匹配 `- [x]`、`- [/]`、`- [ ]` 格式
- 保留任务原始顺序
- 识别嵌套任务（如 `  - [ ] 1.1.1`）

---

## Phase 4: 统计与计算

统计数据：
- 已完成任务数
- 进行中任务数
- 待开始任务数
- 总任务数
- 完成率 = 已完成 / 总数 × 100%

---

## Phase 5: 生成进度报告

```
📊 任务进度报告
提案：<change-id>

✅ 已完成：N/M (XX.X%)
🔄 进行中：N
⬜ 待开始：N

详情：
[x] 1. 任务描述
[x] 2. 任务描述
[/] 3. 任务描述  ← 进行中
[ ] 4. 任务描述
[ ] 5. 任务描述
```

**可选**：标记当前进行中的任务（`← 进行中`）
