# æ•°æ®æ¶æ„æ¨¡æ¿ (Data Architecture Template)

> **Metadata**
> - **Source**: `{{æ¶æ„è®¾è®¡æ–‡æ¡£è·¯å¾„}}`
> - **Generated At**: `{{ç”Ÿæˆæ—¶é—´ YYYY-MM-DD HH:mm}}`
> - **Generator**: `Context-Agent v1.0`

---

## ğŸ“Š æ•°æ®æ¨¡å‹åˆ†å±‚

### æ¦‚å¿µæ•°æ®æ¨¡å‹ (Conceptual)

```mermaid
erDiagram
    USER ||--o{ ORDER : places
    ORDER ||--|{ ORDER_ITEM : contains
    ORDER_ITEM }|--|| PRODUCT : references
    USER ||--o{ PAYMENT : makes
    PAYMENT ||--|| ORDER : "pays for"
```

### æ ¸å¿ƒå®ä½“

| å®ä½“ | æè¿° | å…³ç³» |
|------|------|------|
| **User** | ç³»ç»Ÿç”¨æˆ· | 1:N Order |
| **Order** | è®¢å• | N:1 User, 1:N OrderItem |
| **Product** | å•†å“ | N:1 OrderItem |
| **Payment** | æ”¯ä»˜è®°å½• | 1:1 Order |

---

## ğŸ“‹ é€»è¾‘æ•°æ®æ¨¡å‹ (Logical)

### User

| å­—æ®µ | ç±»å‹ | çº¦æŸ | æè¿° |
|------|------|------|------|
| id | UUID | PK | ç”¨æˆ·ID |
| email | VARCHAR(255) | UNIQUE, NOT NULL | é‚®ç®± |
| password_hash | VARCHAR(255) | NOT NULL | å¯†ç å“ˆå¸Œ |
| status | ENUM | NOT NULL | çŠ¶æ€ |
| created_at | TIMESTAMP | NOT NULL | åˆ›å»ºæ—¶é—´ |

### Order

| å­—æ®µ | ç±»å‹ | çº¦æŸ | æè¿° |
|------|------|------|------|
| id | UUID | PK | è®¢å•ID |
| user_id | UUID | FK(User) | ç”¨æˆ·ID |
| status | ENUM | NOT NULL | è®¢å•çŠ¶æ€ |
| total_amount | DECIMAL(10,2) | NOT NULL | æ€»é‡‘é¢ |
| created_at | TIMESTAMP | NOT NULL | åˆ›å»ºæ—¶é—´ |

---

## ğŸ—„ï¸ ç‰©ç†æ•°æ®æ¨¡å‹ (Physical)

### ç´¢å¼•è®¾è®¡

| è¡¨ | ç´¢å¼•å | å­—æ®µ | ç±»å‹ |
|----|--------|------|------|
| users | idx_users_email | email | UNIQUE |
| orders | idx_orders_user_id | user_id | B-TREE |
| orders | idx_orders_status | status | B-TREE |
| orders | idx_orders_created_at | created_at | B-TREE |

### åˆ†åŒºç­–ç•¥

| è¡¨ | åˆ†åŒºé”® | ç­–ç•¥ | ä¿ç•™æœŸ |
|----|--------|------|--------|
| orders | created_at | æŒ‰æœˆåˆ†åŒº | 3å¹´ |
| logs | created_at | æŒ‰å¤©åˆ†åŒº | 90å¤© |

---

## ğŸ”„ ä¸€è‡´æ€§æ¨¡å‹

| æ•°æ®å­˜å‚¨ | ä¸€è‡´æ€§çº§åˆ« | é€‚ç”¨åœºæ™¯ |
|---------|-----------|---------|
| PostgreSQL | å¼ºä¸€è‡´æ€§ | æ ¸å¿ƒä¸šåŠ¡æ•°æ® |
| Redis | æœ€ç»ˆä¸€è‡´æ€§ | ç¼“å­˜ã€ä¼šè¯ |
| S3 | æœ€ç»ˆä¸€è‡´æ€§ | æ–‡ä»¶å­˜å‚¨ |
| Kafka | At-least-once | äº‹ä»¶æ¶ˆæ¯ |

---

## ğŸ“¦ æ•°æ®å­—å…¸

| å­—æ®µå | æ•°æ®ç±»å‹ | å…è®¸å€¼ | ä¸šåŠ¡å®šä¹‰ | æ‰€æœ‰è€… |
|--------|---------|--------|---------|--------|
| user_status | ENUM | ACTIVE, SUSPENDED, BANNED | ç”¨æˆ·è´¦æˆ·çŠ¶æ€ | ç”¨æˆ·ä¸­å¿ƒ |
| order_status | ENUM | PENDING, PAID, SHIPPED, COMPLETED | è®¢å•ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ | è®¢å•ä¸­å¿ƒ |

---

## ğŸ” æ•°æ®æ²»ç†

| ç­–ç•¥ | æè¿° |
|------|------|
| **æ‰€æœ‰æƒ** | æ¯ä¸ªæ•°æ®åŸŸæœ‰æ˜ç¡®è´£ä»»å›¢é˜Ÿ |
| **ä¿ç•™ç­–ç•¥** | è®¢å•æ•°æ®ä¿ç•™ 7 å¹´ï¼Œæ—¥å¿—ä¿ç•™ 90 å¤© |
| **å½’æ¡£ç­–ç•¥** | è¶…è¿‡ 1 å¹´çš„å†·æ•°æ®è¿ç§»è‡³ S3 Glacier |
| **åˆ é™¤æƒ** | GDPR åˆ é™¤è¯·æ±‚åœ¨ 30 å¤©å†…æ‰§è¡Œ |
