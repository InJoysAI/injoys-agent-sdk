# 测试策略模板 (Testing Strategy Template)

> **Metadata**
> - **Source**: `{{PRD 文档路径}}`
> - **Generated At**: `{{生成时间 YYYY-MM-DD HH:mm}}`
> - **Generator**: `Context-Agent v1.0`

---

## 🎯 验收标准格式 (BDD Gherkin)

所有验收标准采用 Given / When / Then 语法：

```gherkin
场景: [场景名称]
  Given [已知条件/前置状态]
  When [用户执行的动作]
  Then [预期结果]
```

---

## 📋 模块验收标准

### 模块 1: {{模块名称，如：优惠券系统}}

#### 场景 1: 符合条件的优惠券
```gherkin
Given 用户购物车总金额为 $120
  And 账户内有一张"满 $100 减 $20"的优惠券
When 用户在结算页选择该优惠券
Then 订单总额应更新为 $100
  And 优惠券状态显示为"已选中"
  And 页面提示"已优惠 $20"
```

#### 场景 2: 不符合条件的优惠券
```gherkin
Given 用户购物车总金额为 $80
When 用户尝试选择"满 $100 减 $20"的优惠券
Then 系统应禁止选择（置灰）
  And 提示"未满足使用门槛，还差 $20"
```

#### 场景 3: 互斥规则
```gherkin
Given 用户已选择了一张"全场 9 折"的折扣券
When 用户尝试再叠加一张"满减券"
Then 系统应提示"折扣券与满减券不可叠加使用"
  And 询问用户是否替换
```

### 模块 2: {{模块名称}}

#### 场景 1: {{场景名称}}
```gherkin
Given {{前置条件}}
When {{用户动作}}
Then {{预期结果}}
```

---

## 🔺 测试金字塔

| 层级 | 测试类型 | 覆盖率目标 | 工具 |
|------|---------|-----------|------|
| **单元测试** | 业务逻辑、工具函数 | ≥ 80% | {{e.g. Jest, Go test}} |
| **集成测试** | API 接口、数据库交互 | ≥ 70% | {{e.g. Supertest, testify}} |
| **E2E 测试** | 核心用户旅程 | 关键路径 100% | {{e.g. Playwright, Cypress}} |

---

## ⚡ 性能测试目标

| 指标 | 目标值 | 测试场景 |
|------|--------|---------|
| API 平均响应时间 (TP50) | < 200ms | 标准负载 |
| API 99分位响应时间 (TP99) | < 1000ms | 标准负载 |
| 并发用户 (CCU) | 10,000 | 压力测试 |
| 峰值 QPS | 5,000 | 促销场景 |

---

## 🔒 安全测试要求

| 测试项 | 标准 | 验证方式 |
|--------|------|---------|
| HTTPS 强制 | TLS 1.2+ | 证书检查 |
| 密码存储 | bcrypt/Argon2 | 代码审查 |
| SQL 注入 | 参数化查询 | 渗透测试 |
| XSS 防护 | 输入过滤/输出编码 | 渗透测试 |
| CSRF 防护 | Token 验证 | 渗透测试 |

---

## 📝 UAT 流程

| 阶段 | 环境 | 执行人 | 内容 |
|------|------|--------|------|
| **Alpha 验收** | Staging 测试环境 | 产品经理 | 核心功能符合设计预期 |
| **Beta 验收** | 预发布环境 | 业务方（运营/销售） | 真实业务模拟（下单、退款） |
| **Sign-off** | 预发布环境 | 业务方负责人 | P0/P1 Bug 全部修复后签字 |

---

## ✅ Definition of Done

- [ ] 所有 BDD 场景通过
- [ ] 单元测试覆盖率达标
- [ ] 性能测试通过
- [ ] 安全测试无高危漏洞
- [ ] UAT 签收完成
