<!-- CONTEXT_OPENSPEC_INTEGRATION:START -->

---

## üßæ Context Asset Index (Generated)
<!-- CONTEXT_ASSET_INDEX:START -->
> Generated by `/context-openspec`. Do not edit manually.
>
> If this block is missing/outdated, re-run `/context-openspec` (or `/context-openspec <subcommand>`).

- Required:
  - `.context/criterion.md`
  - `.context/context-manifest.json`
- Architecture (if present):
  - `.context/architecture/tech_stack.md`
  - `.context/architecture/security_policy.md`
- Domain (if present):
  - `.context/domain/business_rules.md`
  - `.context/domain/user_journeys.md`
- DB (if present):
  - `.context/db/**`
- UI (if present):
  - `.context/ui/**`
<!-- CONTEXT_ASSET_INDEX:END -->

---

## üìñ Context Asset Reading Specification

When executing OpenSpec workflows, you **MUST** read the following `.context/` assets to ensure proposals and implementations align with project constraints:

### When Creating Proposals (`/context-openspec proposal <change-id>`)

1. **Required Reading**:
   - `CONTEXT_ASSET_INDEX` block in this file ‚Äî Determine which `.context/**` assets exist and must be read for this project
   - `.context/criterion.md` ‚Äî Understand hard constraints (MUST/MUST NOT)
   - `openspec/project.md` ‚Äî Project overview

2. **Read As Needed** (if present per `CONTEXT_ASSET_INDEX`):
   - `.context/architecture/tech_stack.md` ‚Äî Technology stack choices
   - `.context/architecture/security_policy.md` ‚Äî Security requirements
   - `.context/domain/business_rules.md` ‚Äî Business logic rules
   - `.context/domain/user_journeys.md` ‚Äî User journeys

3. **SSoT Reference Files**:
   - `schema/postgres.hcl` ‚Äî Database schema (if exists)
   - `api/main.tsp` ‚Äî API contract (if exists)

### During Review & Align

Read the following files for specification validation (if present per `CONTEXT_ASSET_INDEX`):
- `.context/domain/business_rules.md` ‚Äî Validate business logic
- `.context/architecture/security_policy.md` ‚Äî Validate security requirements
- `.context/domain/user_journeys.md` ‚Äî Verify user flows

### When Implementing Changes (`/context-start`)

1. **Follow Constraints**:
   - Strictly follow MUST/MUST NOT rules in `.context/criterion.md`
   - Use specified technologies per `.context/architecture/tech_stack.md` (if present per `CONTEXT_ASSET_INDEX`)

2. **Use Generated Code**:
   - Database migrations: `atlas schema apply`
   - API interfaces: Code generated by `oapi-codegen` / `orval`
   - Type definitions: OpenAPI generated by `tsp compile`

3. **Modify SSoT Files First** (SSoT-first):
   - Schema changes ‚Üí Modify `schema/postgres.hcl` first
   - API changes ‚Üí Modify `api/main.tsp` first

---

## üîó Context to OpenSpec Mapping

| OpenSpec File | Context Data Source |
|--------------|---------------------|
| `openspec/project.md` | `.context/criterion.md` + `.context/architecture/tech_stack.md` |
| `openspec/proposal-roadmap.md` | `.context/domain/` + `.context/architecture/` |
| Proposal constraints | `.context/criterion.md` (MUST/MUST NOT) |
| Business logic validation | `.context/domain/business_rules.md` |
| User flow validation | `.context/domain/user_journeys.md` |
| Security validation | `.context/architecture/security_policy.md` |

---

## ‚ö†Ô∏è Important Rules

1. **Read Context Before Proposals**: Before creating any proposal, you MUST read `.context/criterion.md`
2. **SSoT First**: Database and API changes MUST modify SSoT files first, then generate code
3. **Keep In Sync**: After `.context/` content changes, run `/context-openspec` to sync `project.md`

---

## üí° Usage Example

```
# User Request
"I want to add an endpoint to update user nickname"

# AI Execution Flow
1. Read .context/criterion.md and openspec/project.md
2. Check for relevant constraints
3. Create openspec/changes/feat-update-nickname/proposal.md
4. After review approval, modify schema/postgres.hcl and api/main.tsp
5. Run codegen commands to generate code
6. Implement business logic
7. Archive the change: openspec archive feat-update-nickname --yes
```

<!-- CONTEXT_OPENSPEC_INTEGRATION:END -->
